{% extends "base.html" %} {% load static %} {% block content %}
<body id="search">
  {% include 'home/header.html' %}

  <div class="container">
    <div class="row">
      <!-- Left Column for the Form -->
      <div class="col-md-6">
        <div class="box">
          <h1>Create or Import Product for {{ company.name }}</h1>
          <form id="product-form" method="post" action="{% url 'product:create_or_import_product' company_id=company.id %}" enctype="multipart/form-data">
            {% csrf_token %}
            <!-- Dynamic Fields -->
            {{ form.as_p }}

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary">Submit Product</button>
          </form>
        </div>
      </div>

      <!-- Right Column for Importing Products -->
      <div class="col-md-6">
        <div class="box">
          <h2>Import Product</h2>
          <label for="product_id">Select Product to Import:</label>
          <select id="product_id" name="product_id" class="form-control">
            <option value="">--- Select Product ---</option>
            {% for product in products %}
            <option value="{{ product.id }}">{{ product.title }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
    </div>
  </div>

  {% include 'home/footer.html' %}

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function () {
        $('#product_id').on('change', function () {
            var productId = $(this).val();
            if (productId) {
                // AJAX call to get product details and fill the form
                $.getJSON('{% url 'product:get_product_details' %}', {id: productId}, function (product) {
                    // Assuming 'product' is the object with product details
                    $('#id_custom_title').val(product.title);
                    $('#id_custom_description').val(product.description);
                    $('#id_custom_price').val(product.price);
                    $('#id_stock_quantity').val(product.stock_quantity);
                    // Add other fields as necessary
                });
            }
        });
    });
  </script>
</body>
{% endblock %}
