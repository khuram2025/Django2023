<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Cropping</title>
    <!-- Cropper.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.9/cropper.min.css" rel="stylesheet" />
    <style>
      .img-preview {
        width: 100px;
        height: 100px;
        overflow: hidden;
        margin-bottom: 20px;
      }
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="bpr-row bpr-row-icon">
      <div class="bpr-utitle">Company logo (100x100 px)</div>
      <div class="bpr-inputs">
        <div class="img-preview"></div>
        <input type="file" name="bpr-file-icon" id="bpr-file-icon" class="bpr-file-icon" />
      </div>
    </div>

    <div class="bpr-row bpr-row-cover">
      <div class="bpr-utitle">Company cover (1600x600 px)</div>
      <div class="bpr-inputs">
        <div class="img-preview"></div>
        <input type="file" name="bpr-file-cover" id="bpr-file-cover" class="bpr-file-cover" />
      </div>
    </div>

    <!-- Hidden Images for Cropper -->
    <img id="logo-image" class="hidden" />
    <img id="cover-image" class="hidden" />

    <!-- Cropper.js and jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.9/cropper.min.js"></script>

    <script>
      $(document).ready(function () {
        var cropperLogo, cropperCover;

        function initCropper(imageElement, aspectRatio, previewSelector) {
          return new Cropper(imageElement, {
            aspectRatio: aspectRatio,
            viewMode: 2,
            preview: previewSelector,
            crop: function (event) {
              // Cropping logic here if needed
            },
          });
        }

        function handleFileChange(event, imageElement, cropperInstance, aspectRatio, previewSelector) {
          var files = event.target.files;
          var allowedExtensions = ["jpeg", "jpg", "png", "gif"];

          if (files && files.length) {
            var fileExtension = files[0].name.split(".").pop().toLowerCase();
            if (!allowedExtensions.includes(fileExtension)) {
              alert("Only formats are allowed: " + allowedExtensions.join(", "));
              return false;
            }

            var reader = new FileReader();
            reader.onload = function (e) {
              if (cropperInstance) cropperInstance.destroy();
              imageElement.src = e.target.result;
              cropperInstance = initCropper(imageElement, aspectRatio, previewSelector);
            };
            reader.readAsDataURL(files[0]);
          }
        }

        $("#bpr-file-icon").on("change", function (event) {
          handleFileChange(event, document.getElementById("logo-image"), cropperLogo, 1, ".bpr-row-icon .img-preview");
        });

        $("#bpr-file-cover").on("change", function (event) {
          handleFileChange(event, document.getElementById("cover-image"), cropperCover, 1600 / 600, ".bpr-row-cover .img-preview");
        });
      });
    </script>
  </body>
</html>
