<div id="search-menu" class="filter-menu" class="default-font font-size-14">
  <div class="wrap" class="default-font font-size-14">
    <form action="{% url 'product:product_search' %}" method="GET" class="search-side-form nocsrf" class="default-font font-size-14">
      <input type="hidden" class="ajaxRun" value="" class="default-font font-size-15" />
      <input type="hidden" name="page" value="search" class="default-font font-size-15" />
      <input type="hidden" name="sOrder" value="dt_pub_date" class="default-font font-size-15" />
      <input type="hidden" name="iOrderType" value="desc" class="default-font font-size-15" />
      <input type="hidden" name="sCountry" id="sCountry" value="" class="default-font font-size-15" />
      <input type="hidden" name="sRegion" id="sRegion" value="" class="default-font font-size-15" />
      <input type="hidden" name="sCity" id="sCity" value="" class="default-font font-size-15" />
      <input type="hidden" name="iPage" id="iPage" value="" class="default-font font-size-15" />
      <input type="hidden" name="sShowAs" id="sShowAs" value="" class="default-font font-size-15" />
      <input type="hidden" name="userId" value="" class="default-font font-size-15" />
      <input type="hidden" name="notFromUserId" value="" class="default-font font-size-15" />

      <div class="row isMobile">
        <label for="sCategory">Category</label>
        <div class="input-box">
          <select name="sCategory" id="sCategory" onchange="filterByCategory()">
            <option value="">Category...</option>
            {% for category in categories %}
            <option value="{{ category.id }}" data-slug="{{ category.slug }}">{{ category.title }}</option>
            {% for subcategory in category.children.all %}
            <option value="{{ subcategory.id }}" data-slug="{{ subcategory.slug }}">&nbsp;&nbsp;{{ subcategory.title }}</option>
            {% endfor %} {% endfor %}
          </select>
        </div>
      </div>

      <div class="row" class="default-font font-size-14">
        <label for="sLocation" class="default-font font-size-14">Location</label>

        <div class="input-box picker location only-search" class="default-font font-size-14">
          <input name="sLocation" type="text" id="sLocation" placeholder="Region, city..." value="{{ selected_location }}" autocomplete="off" />

          <i class="clean fas fa-times-circle" speechify-initial-font-family='"Font Awesome 5 Free"' speechify-initial-font-size="16px"></i>
          <div class="results" class="default-font font-size-14"></div>
        </div>
      </div>

      <!-- PRICE -->
      <div class="row price" class="default-font font-size-14">
        <label for="sPriceMin" class="default-font font-size-14">Price range ($)</label>

        <div class="line input-box" class="default-font font-size-14">
          <input type="number" class="priceMin" name="sPriceMin" id="sPriceMin" value="" size="6" maxlength="6" placeholder="Min" class="default-font font-size-15" />
          <span class="delim" class="default-font font-size-14"></span>
          <input type="number" class="priceMax" name="sPriceMax" id="sPriceMax" value="" size="6" maxlength="6" placeholder="Max" class="default-font font-size-15" />
        </div>

        <div class="row check-only checkboxes" class="default-font font-size-14">
          <div class="input-box-check" class="default-font font-size-14">
            <input type="checkbox" name="bPriceCheckWithSeller" id="bPriceCheckWithSeller" value="1" class="default-font font-size-15" />
            <label for="bPriceCheckWithSeller" class="only-check-label" class="default-font font-size-13">Ask Seller</label>
          </div>
        </div>

        <div class="row free-only checkboxes" class="default-font font-size-14">
          <div class="input-box-check" class="default-font font-size-14">
            <input type="checkbox" name="bPriceFree" id="bPriceFree" value="1" class="default-font font-size-15" />
            <label for="bPriceFree" class="only-free-label" class="default-font font-size-13">Free</label>
          </div>
        </div>
      </div>

      <!-- PERIOD-->
      <div class="row period" class="default-font font-size-14">
        <label for="sPriceMin" class="default-font font-size-14">Period</label>
        <div class="input-box" class="default-font font-size-14">
          <select class="sPeriod" id="sPeriod" name="sPeriod" class="default-font font-size-15" onchange="filterByPeriod()">
            <option value="" class="default-font font-size-15">All</option>
            <option value="1" class="default-font font-size-15">Yesterday</option>
            <option value="7" class="default-font font-size-15">Last week</option>
            <option value="14" class="default-font font-size-15">Last 2 weeks</option>
            <option value="31" class="default-font font-size-15">Last month</option>
            <option value="365" class="default-font font-size-15">Last year</option>
          </select>
        </div>
      </div>
      <!-- Existing search form fields -->

      {% for field in custom_fields %}
      <div class="form-group">
        <label>{{ field.name }}</label>
        {% if field.field_type == 'number' or field.field_type == 'email' or field.field_type == 'phone' or field.field_type == 'url' %}
        <input type="{{ field.field_type }}" name="custom_{{ field.id }}" class="form-control" />
        {% elif field.field_type == 'textarea' %}
        <textarea name="custom_{{ field.id }}" class="form-control"></textarea>
        {% elif field.field_type == 'select' %}
        <select name="custom_{{ field.id }}" class="form-control">
          {% for option in field.options_list %}
          <option value="{{ option }}">{{ option }}</option>
          {% endfor %}
        </select>
        {% elif field.field_type == 'checkbox' %} {% for option in field.options_list %}
        <div class="checkbox">
          <label> <input type="checkbox" name="custom_{{ field.id }}" value="{{ option }}" /> {{ option }} </label>
        </div>
        {% endfor %} {% elif field.field_type == 'radio' %} {% for option in field.options_list %}
        <div class="radio">
          <label> <input type="radio" name="custom_{{ field.id }}" value="{{ option }}" /> {{ option }} </label>
        </div>
        {% endfor %} {% elif field.field_type == 'date' %}
        <input type="date" name="custom_{{ field.id }}" class="form-control" />
        {% elif field.field_type == 'color' %}
        <input type="color" name="custom_{{ field.id }}" class="form-control" />
        {% elif field.field_type == 'date_interval' %}
        <!-- Custom implementation for date interval -->
        {% endif %}
      </div>
      {% endfor %}

      <!-- Existing form submit button -->

      <!-- COMPANY -->
      <div class="row buttons srch" class="default-font font-size-14">
        <button type="submit" class="btn mbBg init-search" id="search-button" class="default-font font-size-16">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="18" height="18" class="default-font font-size-16"><path d="M508.5 468.9L387.1 347.5c-2.3-2.3-5.3-3.5-8.5-3.5h-13.2c31.5-36.5 50.6-84 50.6-136C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c52 0 99.5-19.1 136-50.6v13.2c0 3.2 1.3 6.2 3.5 8.5l121.4 121.4c4.7 4.7 12.3 4.7 17 0l22.6-22.6c4.7-4.7 4.7-12.3 0-17zM208 368c-88.4 0-160-71.6-160-160S119.6 48 208 48s160 71.6 160 160-71.6 160-160 160z" class="default-font font-size-16"></path></svg>
          <span class="default-font font-size-16">Search</span>
        </button>
      </div>
    </form>
  </div>

  <div id="search-category-box" class="default-font font-size-14">
    <h3 class="default-font font-size-16">Select Category</h3>
    <div class="wrap nice-scroll-nothave-overflow">
      <div class="catbox root nice-scroll">
        {% for cat in categories %}
        <a href="{% url 'product:product_list_by_category' cat.slug %}" class="child {% if cat.slug == category.slug %}active{% endif %}">
          <div class="icon">
            {% if cat.icon %}
            <img src="{{ cat.icon.url }}" alt="{{ cat.title }}" />
            {% endif %}
          </div>
          <div>
            <span class="name">{{ cat.title }}</span>
            <!-- Display product count if needed -->
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Display the products -->
  <!-- Your code to display products goes here -->

  <div id="banner-theme" class="banner-theme banner-search_sidebar not767 is-demo" class="default-font font-size-14">
    <div class="myad" speechify-initial-font-family="monospace" speechify-initial-font-size="14px">
      <div class="text" speechify-initial-font-family="monospace" speechify-initial-font-size="16px">
        <a href="https://www.a2hosting.com?aid=5ff74858d3bac&amp;bid=8fc96e08" target="_top" speechify-initial-font-family="monospace" speechify-initial-font-size="16px"><img src="//affiliates.a2hosting.com/accounts/default1/banners/8fc96e08.jpg" alt="A2 Hosting Springing Into Summer Sale" title="A2 Hosting Springing Into Summer Sale" width="250" height="250" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" /></a><img style="border: 0" src="https://affiliates.a2hosting.com/scripts/imp.php?aid=5ff74858d3bac&amp;bid=8fc96e08" width="1" height="1" alt="" speechify-initial-font-family="monospace" speechify-initial-font-size="16px" />
      </div>
    </div>
  </div>
</div>
